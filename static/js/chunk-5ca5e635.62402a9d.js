(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ca5e635"],{"7db0":function(e,t,n){"use strict";var i=n("23e7"),a=n("b727").find,o=n("44d2"),r=n("ae40"),s="find",c=!0,l=r(s);s in[]&&Array(1)[s]((function(){c=!1})),i({target:"Array",proto:!0,forced:c||!l},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),o(s)},a74c:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{padding:"0 50px 0 50px"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isDivVisible,expression:"isDivVisible"}]},[n("vxe-toolbar",{scopedSlots:e._u([{key:"buttons",fn:function(){return[n("vxe-button",{attrs:{icon:"vxe-icon-square-plus",status:"primary"},on:{click:e.addProductEvent}},[e._v("添加产品")]),n("vxe-button",{attrs:{icon:"vxe-icon-save",status:"primary"},on:{click:e.saveEvent}},[e._v("保存")])]},proxy:!0}])}),n("vxe-form",{staticStyle:{"margin-left":"-10px"},attrs:{"title-align":"right","title-width":"100"}},[n("vxe-form-item",{attrs:{title:"客户名称",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[n("vxe-select",{attrs:{placeholder:"请搜索",options:e.shipping_options.customer_name_options,clearable:"",filterable:""},on:{change:e.getProductList},model:{value:e.modalForm.customer_name,callback:function(t){e.$set(e.modalForm,"customer_name",t)},expression:"modalForm.customer_name"}})]},proxy:!0}])}),n("vxe-form-item",{attrs:{title:"出货日期",span:5}},[n("vxe-input",{ref:"datainpnt",attrs:{type:"date",placeholder:"请选择日期",clearable:""},model:{value:e.modalForm.delivery_date,callback:function(t){e.$set(e.modalForm,"delivery_date",t)},expression:"modalForm.delivery_date"}})],1),n("vxe-form-item",{attrs:{title:"收货地址",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[n("vxe-select",{attrs:{placeholder:"请搜索",options:e.shipping_options.shipping_address_options,clearable:"",filterable:""},on:{change:e.getProjectInfo},model:{value:e.modalForm.shipping_address,callback:function(t){e.$set(e.modalForm,"shipping_address",t)},expression:"modalForm.shipping_address"}})]},proxy:!0}])}),n("vxe-form-item",{attrs:{title:"司机",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[n("vxe-select",{attrs:{placeholder:"请搜索",options:e.shipping_options.driver_name_options,clearable:"",filterable:""},on:{change:e.getDriverInfo},model:{value:e.modalForm.driver_name,callback:function(t){e.$set(e.modalForm,"driver_name",t)},expression:"modalForm.driver_name"}})]},proxy:!0}])}),n("vxe-form-item",{attrs:{title:"发货人",span:4},scopedSlots:e._u([{key:"default",fn:function(){return[n("vxe-select",{attrs:{placeholder:"请搜索",options:e.shipping_options.username_options,clearable:"",filterable:""},model:{value:e.modalForm.username,callback:function(t){e.$set(e.modalForm,"username",t)},expression:"modalForm.username"}})]},proxy:!0}])})],1),n("vxe-form",{staticStyle:{"margin-left":"-10px"},attrs:{"title-align":"right","title-width":"100"}},[n("vxe-form-item",{attrs:{title:"收货人",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[n("vxe-input",{attrs:{placeholder:"",disabled:""},model:{value:e.modalForm.project_contact_name,callback:function(t){e.$set(e.modalForm,"project_contact_name",t)},expression:"modalForm.project_contact_name"}})]},proxy:!0}])}),n("vxe-form-item",{attrs:{title:"收货联系方式",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[n("vxe-input",{attrs:{placeholder:"",disabled:""},model:{value:e.modalForm.project_contact_phone,callback:function(t){e.$set(e.modalForm,"project_contact_phone",t)},expression:"modalForm.project_contact_phone"}})]},proxy:!0}])}),n("vxe-form-item",{attrs:{title:"车牌",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[n("vxe-input",{attrs:{placeholder:"",disabled:""},model:{value:e.modalForm.licence_plate,callback:function(t){e.$set(e.modalForm,"licence_plate",t)},expression:"modalForm.licence_plate"}})]},proxy:!0}])})],1),n("vxe-table",{ref:"xTable",attrs:{border:"","show-overflow":"","keep-source":"","max-height":"auto",data:e.shiptableData,"edit-config":{trigger:"click",mode:"cell",icon:"vxe-icon-edit",showStatus:!0}}},[n("vxe-column",{attrs:{type:"seq",width:"60",title:"序号"}}),n("vxe-column",{attrs:{field:"detailid",title:"产品ID",visible:!1},scopedSlots:e._u([{key:"edit",fn:function(t){var i=t.row;return[n("vxe-input",{attrs:{type:"text"},model:{value:i.detailid,callback:function(t){e.$set(i,"detailid",t)},expression:"row.detailid"}})]}}])}),n("vxe-column",{attrs:{field:"order_number_id",title:"订单号码"},scopedSlots:e._u([{key:"edit",fn:function(t){var i=t.row;return[n("vxe-input",{attrs:{type:"text"},model:{value:i.order_number_id,callback:function(t){e.$set(i,"order_number_id",t)},expression:"row.order_number_id"}})]}}])}),n("vxe-column",{attrs:{field:"commodity_details",title:"品名"},scopedSlots:e._u([{key:"edit",fn:function(t){var i=t.row;return[n("vxe-input",{attrs:{type:"text"},model:{value:i.commodity_details,callback:function(t){e.$set(i,"commodity_details",t)},expression:"row.commodity_details"}})]}}])}),n("vxe-column",{attrs:{field:"commodity_size",title:"规格"},scopedSlots:e._u([{key:"edit",fn:function(t){var i=t.row;return[n("vxe-input",{attrs:{type:"text"},model:{value:i.commodity_size,callback:function(t){e.$set(i,"commodity_size",t)},expression:"row.commodity_size"}})]}}])}),n("vxe-column",{attrs:{field:"control_no",title:"编号"},scopedSlots:e._u([{key:"edit",fn:function(t){var i=t.row;return[n("vxe-input",{attrs:{type:"text"},model:{value:i.control_no,callback:function(t){e.$set(i,"control_no",t)},expression:"row.control_no"}})]}}])}),n("vxe-column",{attrs:{field:"commodity_units",title:"单位"},scopedSlots:e._u([{key:"edit",fn:function(t){var i=t.row;return[n("vxe-input",{attrs:{type:"text"},model:{value:i.commodity_units,callback:function(t){e.$set(i,"commodity_units",t)},expression:"row.commodity_units"}})]}}])}),n("vxe-column",{attrs:{field:"shipping_quantity",title:"发货数量","edit-render":{autofocus:".vxe-input--inner",defaultValue:"0"}},scopedSlots:e._u([{key:"edit",fn:function(t){var i=t.row;return[n("vxe-input",{attrs:{type:"text"},on:{change:function(t){return e.handleChange(i)}},nativeOn:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnterUp(i)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.onDownUp(i)}]},model:{value:i.shipping_quantity,callback:function(t){e.$set(i,"shipping_quantity",t)},expression:"row.shipping_quantity"}})]}}])}),n("vxe-column",{attrs:{field:"shipping_weight",title:"发货重量"},scopedSlots:e._u([{key:"edit",fn:function(t){var i=t.row;return[n("vxe-input",{attrs:{type:"text"},model:{value:i.shipping_weight,callback:function(t){e.$set(i,"shipping_weight",t)},expression:"row.shipping_weight"}})]}}])}),n("vxe-column",{attrs:{field:"unit_weight",title:"单件重量"},scopedSlots:e._u([{key:"edit",fn:function(t){var i=t.row;return[n("vxe-input",{attrs:{type:"text"},model:{value:i.unit_weight,callback:function(t){e.$set(i,"unit_weight",t)},expression:"row.unit_weight"}})]}}])}),n("vxe-column",{attrs:{field:"commodity_quantity",title:"库存数量"},scopedSlots:e._u([{key:"edit",fn:function(t){var i=t.row;return[n("vxe-input",{attrs:{type:"text"},model:{value:i.commodity_quantity,callback:function(t){e.$set(i,"commodity_quantity",t)},expression:"row.commodity_quantity"}})]}}])}),n("vxe-column",{attrs:{field:"remarks",title:"备注"},scopedSlots:e._u([{key:"edit",fn:function(t){var i=t.row;return[n("vxe-input",{attrs:{type:"text"},model:{value:i.remarks,callback:function(t){e.$set(i,"remarks",t)},expression:"row.remarks"}})]}}])}),n("vxe-column",{attrs:{title:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[n("vxe-button",{attrs:{status:"danger",content:"删除"},on:{click:function(t){return e.deleteRowEvent(i)}}})]}}])})],1),n("vxe-modal",{attrs:{title:"选择产品",width:"800",resize:"","destroy-on-close":""},model:{value:e.modalDisplay,callback:function(t){e.modalDisplay=t},expression:"modalDisplay"}},[n("div",{staticStyle:{"text-align":"center","margin-top":"10px","margin-bottom":"10px"}},[n("vxe-input",{attrs:{type:"search",placeholder:"全局搜索"},on:{change:e.searchEvent},model:{value:e.searchOrderNumber,callback:function(t){e.searchOrderNumber=t},expression:"searchOrderNumber"}})],1),n("vxe-table",{ref:"xTableOrders",attrs:{data:e.list,size:"small","show-overflow":"",height:"500","checkbox-config":{trigger:"row",highlight:!0,range:!0,checkField:"checked"}},on:{"checkbox-change":e.handleCheckboxChange,"checkbox-all":e.handleCheckAll,"checkbox-range-end":e.handleCheckboxRangeChange}},[n("vxe-column",{staticStyle:{"text-align":"center"},attrs:{type:"checkbox",title:"选择",width:"80"}}),n("vxe-column",{staticStyle:{"text-align":"center"},attrs:{field:"commodity_details",title:"品名"}}),n("vxe-column",{staticStyle:{"text-align":"center"},attrs:{field:"order_number_id",title:"订单号码"}}),n("vxe-column",{staticStyle:{"text-align":"center"},attrs:{field:"commodity_size",title:"规格"}}),n("vxe-column",{staticStyle:{"text-align":"center"},attrs:{field:"control_no",title:"编号",width:"120"}}),n("vxe-column",{staticStyle:{"text-align":"center"},attrs:{field:"commodity_quantity",title:"库存数量",width:"80"}})],1),n("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[n("vxe-button",{attrs:{status:"primary",content:"确认"},on:{click:e.addProductListEvent}})],1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.isDivVisible,expression:"!isDivVisible"}]},[n("h4",[e._v("提示：请先到发货单管理菜单添加发货单。")])])])},a=[],o=n("c7eb"),r=n("1da1"),s=n("b85c"),c=n("5530"),l=(n("4de4"),n("7db0"),n("c740"),n("d81d"),n("a434"),n("b0c0"),n("b680"),n("d3b7"),n("4d63"),n("ac1f"),n("2c3e"),n("25f0"),n("5319"),n("498a"),n("159b"),n("a388")),d=n.n(l),u=n("d96b"),p=n("2f62"),m=n("c695"),h=n.n(m),f={computed:Object(c["a"])({},Object(p["b"])(["sidebar","avatar","device","name"])),data:function(){return{tablePage:{total:0,currentPage:1,pageSize:1e3},checkboxConfig:{reserve:!0},gridOptionsProduct:{resizable:!0,showOverflow:!0,border:"inner",rowConfig:{keyField:"inventoryid",isHover:!0},checkboxConfig:{reserve:!0}},selectoptions:{},isDivVisible:!1,current_shippingid:"",shipping_options:{},modalForm:{project_contact_name:"",shipping_address:"",project_contact_phone:"",driver_name:"",customer_name:"",delivery_date:"",licence_plate:"",username:"",order_number_id:""},searchOrderNumber:"",searchClientNumber:"",modalDisplay:!1,list:[],tableData:[],shiptableData:[]}},created:function(){this.current_shippingid=this.$route.query.shippingid,void 0===this.$route.query.shippingid?this.isDivVisible=!1:(this.isDivVisible=!0,this.getShippingInfo(),this.getShippingProductList(),this.getShippingOptions())},mounted:function(){this.modalForm.username=this.name,this.getOptions()},methods:{handleCheckboxRangeChange:function(e){var t=this,n=(e.$event,this.$refs.xTableOrders.getTableData().fullData);n.forEach((function(e,n){t.tableData[n].checked=e.checked}))},handleCheckAll:function(e,t,n){var i,a=this,o=Object(s["a"])(this.list);try{var r=function(){var e=i.value;console.log(e.checked);var t=a.tableData.findIndex((function(t){return t.detailid===e.detailid}));console.log(a.tableData[t].checked),a.tableData[t].checked=e.checked};for(o.s();!(i=o.n()).done;)r()}catch(c){o.e(c)}finally{o.f()}},handleCheckboxChange:function(e,t,n){var i=this.tableData.findIndex((function(t){return t.detailid===e.row.detailid}));this.tableData[i].checked=e.checked},handleChange:function(e){e.shipping_quantity-e.commodity_quantity>0?(d.a.modal.message({content:"发货数量不可大于库存数量",status:"error"}),e.shipping_quantity=""):e.shipping_weight=(e.shipping_quantity*e.unit_weight).toFixed(2)},onEnterUp:function(e,t){this.gotoNextRow(e)},onDownUp:function(e){e.shipping_quantity=e.commodity_quantity,e.shipping_weight=(e.shipping_quantity*e.unit_weight).toFixed(2),this.gotoNextRow(e)},getOptions:function(){var e=this,t={action:"product_list_view",subaction:"getOptions"};Object(u["a"])(t).then((function(t){console.log(t.data),e.selectoptions=t.data}))},getProjectInfo:function(e){var t=this,n=e.value;e.$event;if(null!==n){var i={action:"project_table_view",subaction:"getProjectInfo",shipping_address:n};Object(u["a"])(i).then((function(e){t.modalForm.project_contact_name=e.data.project_contact_name,t.modalForm.project_contact_phone=e.data.project_contact_phone}))}},getDriverInfo:function(e){var t=this,n=e.value,i=(e.$event,{action:"driver_table_view",subaction:"getDriverInfo",driver_name:n});Object(u["a"])(i).then((function(e){t.modalForm.licence_plate=e.data.licence_plate}))},getShippingOptions:function(){var e=this,t={action:"shipping_detail_table_view",subaction:"getShippingOptions",searchForm:{username:this.name}};Object(u["a"])(t).then((function(t){e.shipping_options=t.data}))},getShippingInfo:function(){var e=this;return Object(r["a"])(Object(o["a"])().mark((function t(){var n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n={action:"shipping_table_view",subaction:"query",pageNum:1,pageSize:1,searchForm:{shippingid:e.current_shippingid,username:e.name}},Object(u["a"])(n).then((function(t){var n=t.data[0];e.modalForm.customer_name=n.customer_name}));case 2:case"end":return t.stop()}}),t)})))()},getShippingProductList:function(){var e=this;return Object(r["a"])(Object(o["a"])().mark((function t(){var n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n={action:"shipping_detail_table_view",subaction:"getProductListByShippingId",shippingid:e.current_shippingid,username:e.name},Object(u["a"])(n).then((function(t){e.shiptableData=t.data}));case 2:case"end":return t.stop()}}),t)})))()},getProductList:function(){var e=this;return Object(r["a"])(Object(o["a"])().mark((function t(){var n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n={action:"order_detail_table_view",subaction:"query",pageNum:1,pageSize:1e4,searchForm:{customer_name:e.modalForm.customer_name,username:e.name}},Object(u["a"])(n).then((function(t){e.tableData=t.data;for(var n=e.tableData.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{checked:!1})})),i=n.length-1;i>=0;i--){var a=n[i];0===a.commodity_quantity&&n.splice(i,1)}e.tableData=n,e.searchEvent()}));case 2:case"end":return t.stop()}}),t)})))()},searchEvent:function(){var e=h.a.toValueString(this.searchOrderNumber).trim().toLowerCase();if(e){var t=new RegExp(e,"gi"),n=["order_number_id","control_no","commodity_details"],i=this.tableData.filter((function(t){return n.some((function(n){return h.a.toValueString(t[n]).toLowerCase().indexOf(e)>-1}))}));this.list=i.map((function(e){var i=Object.assign({},e);return n.forEach((function(e){i[e]=h.a.toValueString(i[e]).replace(t,(function(e){return e}))})),i}))}else this.list=this.tableData;console.log(this.list)},addProductEvent:function(e){var t=this;return Object(r["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==t.modalForm.customer_name){e.next=3;break}return d.a.modal.message({content:"请选择客户名称",status:"error"}),e.abrupt("return");case 3:if(""!==t.modalForm.shipping_address){e.next=6;break}return d.a.modal.message({content:"请选择收货地址",status:"error"}),e.abrupt("return");case 6:if(""!==t.modalForm.driver_name){e.next=9;break}return d.a.modal.message({content:"请选择司机",status:"error"}),e.abrupt("return");case 9:if(""!==t.modalForm.username){e.next=12;break}return d.a.modal.message({content:"请选择发货人",status:"error"}),e.abrupt("return");case 12:if(""!==t.modalForm.delivery_date){e.next=15;break}return d.a.modal.message({content:"请选择出货日期",status:"error"}),e.abrupt("return");case 15:t.modalDisplay=!0;case 16:case"end":return e.stop()}}),e)})))()},isDetailIdExists:function(e){var t,n=Object(s["a"])(this.shiptableData);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.detailid===e)return!0}}catch(a){n.e(a)}finally{n.f()}return!1},addProductListEvent:function(){var e,t=this,n=this.tableData,i=Object(s["a"])(n);try{var a=function(){var n=e.value,i=t.shiptableData.findIndex((function(e){return e.detailid===n.detailid}));!0!==n.checked||t.shiptableData.find((function(e){return e.detailid===n.detailid}))?!1===n.checked&&t.shiptableData.find((function(e){return e.detailid===n.detailid}))&&t.shiptableData.splice(i,1):(n.shipping_quantity="",t.shiptableData.push(n))};for(i.s();!(e=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}this.modalDisplay=!1},saveEvent:function(){var e=this;this.current_shippingid=Math.floor(Date.now())%1e8;var t=this.shiptableData.findIndex((function(e){return""===e.shipping_quantity||isNaN(e.shipping_quantity)}));if(-1===t){var n=this.shiptableData;console.log(n);var i={action:"shipping_detail_table_view",subaction:"saveShippingInfoNew",customer_name:this.modalForm.customer_name,shipping_address:this.modalForm.shipping_address,driver_name:this.modalForm.driver_name,delivery_date:this.modalForm.delivery_date,username:this.modalForm.username,shippingid:this.current_shippingid,productlist:n.map((function(e){return{detailid:e.detailid,shipping_quantity:e.shipping_quantity,shipping_weight:e.shipping_weight,order_number_id:e.order_number_id}}))};Object(u["a"])(i).then((function(t){e.$router.back(),d.a.modal.message({content:"保存成功",status:"success"})}))}else d.a.modal.message({content:"发货数量不可为空,或者必须为数字。",status:"warning"})},deleteRowEvent:function(e){var t=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){t.tableData.find((function(t){return t._X_ROW_KEY===e._X_ROW_KEY})).checked=!1;var n=t.shiptableData.findIndex((function(t){return t._X_ROW_KEY===e._X_ROW_KEY}));-1!==n&&t.shiptableData.splice(n,1)}))},gotoNextRow:function(e){var t=this,n=this.shiptableData.indexOf(e),i=n+1;if(i<this.shiptableData.length)this.$nextTick((function(){var e=0;e=0===n?14:14+10*n;var i=t.$refs.xTable.$el.querySelectorAll(".vxe-cell--label")[e];i&&i.click()}));else{var a=this.$refs.xTable.$el.querySelectorAll(".vxe-cell--label")[5];console.warn(a),a&&(console.warn("找到数据"),a.click(),a.focus()),console.warn("No next row available")}}}},v=f,_=n("2877"),b=Object(_["a"])(v,i,a,!1,null,"a70d01e0",null);t["default"]=b.exports},d96b:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var i=n("b775");function a(e){return Object(i["a"])({url:"/vue-element-admin/backend/process/",method:"post",data:e})}function o(e){return Object(i["a"])({url:"/vue-element-admin/backend/download_file/",method:"get",params:e})}}}]);