(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7092fae3"],{"3b64":function(t,e){},"463b":function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticStyle:{padding:"0 50px 0 50px"}},[o("vxe-grid",t._b({ref:"xGrid",on:{"checkbox-change":t.handleCheckboxChange},scopedSlots:t._u([{key:"search_buttons",fn:function(){return[o("h2",{staticStyle:{color:"black"}},[t._v("订单号码："+t._s(t.searchFormData.order_number))])]},proxy:!0},{key:"toolbar_buttons",fn:function(){return[o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.addRow()}}},[t._v("添加产品")]),o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.addRowBatch()}}},[t._v("批量添加")]),o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.getSelectEvent()}}},[t._v("批量工艺")]),o("vxe-button",{attrs:{status:"danger"},on:{click:function(e){return t.getSelectEventDelete()}}},[t._v("批量删除")])]},proxy:!0},{key:"operation",fn:function(e){var i=e.row;return[o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.editRow(i)}}},[t._v("编辑")]),o("vxe-button",{attrs:{status:"danger"},on:{click:function(e){return t.deleteRow(i)}}},[t._v("删除")]),o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.addProcessRow(i)}}},[t._v("添加工艺")]),o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.queryProcessRow(i)}}},[t._v("查看工艺")])]}},{key:"empty",fn:function(){return[o("span",{},[o("p",[t._v("没有数据！")])])]},proxy:!0}])},"vxe-grid",t.gridOptions,!1)),o("vxe-modal",{attrs:{title:t.title,width:"500",resize:"","destroy-on-close":""},model:{value:t.modalProcessDisplay,callback:function(e){t.modalProcessDisplay=e},expression:"modalProcessDisplay"}},[o("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[o("el-checkbox",{attrs:{label:"切割"}}),o("el-checkbox",{attrs:{label:"折弯"}}),o("el-checkbox",{attrs:{label:"组装"}}),o("el-checkbox",{attrs:{label:"焊接"}}),o("el-checkbox",{attrs:{label:"验焊"}}),o("el-checkbox",{attrs:{label:"镀锌"}}),o("el-checkbox",{attrs:{label:"喷涂"}}),o("el-checkbox",{attrs:{label:"攻牙"}}),o("el-checkbox",{attrs:{label:"包装"}}),o("br"),o("el-checkbox",{attrs:{label:"其它"}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.other_process,expression:"other_process"}],staticClass:"underline-input",staticStyle:{"margin-left":"10px"},attrs:{type:"text",placeholder:"输入其他工艺"},domProps:{value:t.other_process},on:{input:function(e){e.target.composing||(t.other_process=e.target.value)}}})],1),o("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[o("el-button",{on:{click:function(e){return t.cancleProcess()}}},[t._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addProcess()}}},[t._v("添加")])],1)],1),o("vxe-modal",{attrs:{title:"新增",width:"500",resize:"","destroy-on-close":""},model:{value:t.modalDisplay,callback:function(e){t.modalDisplay=e},expression:"modalDisplay"}},[o("vxe-form",{attrs:{"title-align":"right","title-width":"100"},on:{submit:t.modalSubmitEvent}},[o("vxe-form-item",{attrs:{title:"订单号码",span:24}},[o("span",[t._v(t._s(t.searchFormData.order_number))])]),o("vxe-form-item",{attrs:{title:"品名",span:24}},[o("vxe-input",{model:{value:t.modalForm.commodity_details,callback:function(e){t.$set(t.modalForm,"commodity_details",e)},expression:"modalForm.commodity_details"}})],1),o("vxe-form-item",{attrs:{title:"规格",span:24}},[o("vxe-input",{model:{value:t.modalForm.commodity_size,callback:function(e){t.$set(t.modalForm,"commodity_size",e)},expression:"modalForm.commodity_size"}})],1),o("vxe-form-item",{attrs:{title:"编号",span:24}},[o("vxe-input",{model:{value:t.modalForm.control_no,callback:function(e){t.$set(t.modalForm,"control_no",e)},expression:"modalForm.control_no"}})],1),o("vxe-form-item",{attrs:{title:"单位",span:24}},[o("vxe-input",{model:{value:t.modalForm.commodity_units,callback:function(e){t.$set(t.modalForm,"commodity_units",e)},expression:"modalForm.commodity_units"}})],1),o("vxe-form-item",{attrs:{title:"数量",span:24}},[o("vxe-input",{model:{value:t.modalForm.commodity_quantity,callback:function(e){t.$set(t.modalForm,"commodity_quantity",e)},expression:"modalForm.commodity_quantity"}})],1),o("vxe-form-item",{attrs:{title:"单件重量",span:24}},[o("vxe-input",{model:{value:t.modalForm.unit_weight,callback:function(e){t.$set(t.modalForm,"unit_weight",e)},expression:"modalForm.unit_weight"}})],1),o("vxe-form-item",{attrs:{title:"备注",span:24}},[o("vxe-input",{model:{value:t.modalForm.remarks,callback:function(e){t.$set(t.modalForm,"remarks",e)},expression:"modalForm.remarks"}})],1),o("vxe-form-item",{attrs:{align:"center","title-align":"center",span:24}},[o("vxe-button",{attrs:{type:"reset"},on:{click:function(e){t.modalDisplay=!1}}},[t._v("取消")]),o("vxe-button",{attrs:{type:"submit",status:"primary"}},[t._v("提交")])],1)],1)],1),o("vxe-modal",{attrs:{title:"编辑",width:"500",resize:"","destroy-on-close":""},model:{value:t.modalEditDisplay,callback:function(e){t.modalEditDisplay=e},expression:"modalEditDisplay"}},[o("vxe-form",{attrs:{"title-align":"right","title-width":"100"},on:{submit:t.modalEditSubmitEvent}},[o("vxe-form-item",{attrs:{title:"订单号码",span:24}},[o("span",[t._v(t._s(t.searchFormData.order_number))])]),o("vxe-form-item",{attrs:{title:"品名",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.commodity_details,callback:function(e){t.$set(t.modalEditForm,"commodity_details",e)},expression:"modalEditForm.commodity_details"}})],1),o("vxe-form-item",{attrs:{title:"规格",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.commodity_size,callback:function(e){t.$set(t.modalEditForm,"commodity_size",e)},expression:"modalEditForm.commodity_size"}})],1),o("vxe-form-item",{attrs:{title:"编号",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.control_no,callback:function(e){t.$set(t.modalEditForm,"control_no",e)},expression:"modalEditForm.control_no"}})],1),o("vxe-form-item",{attrs:{title:"单位",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.commodity_units,callback:function(e){t.$set(t.modalEditForm,"commodity_units",e)},expression:"modalEditForm.commodity_units"}})],1),o("vxe-form-item",{attrs:{title:"数量",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.commodity_quantity,callback:function(e){t.$set(t.modalEditForm,"commodity_quantity",e)},expression:"modalEditForm.commodity_quantity"}})],1),o("vxe-form-item",{attrs:{title:"单件重量",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.unit_weight,callback:function(e){t.$set(t.modalEditForm,"unit_weight",e)},expression:"modalEditForm.unit_weight"}})],1),o("vxe-form-item",{attrs:{title:"备注",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.remarks,callback:function(e){t.$set(t.modalEditForm,"remarks",e)},expression:"modalEditForm.remarks"}})],1),o("vxe-form-item",{attrs:{align:"center","title-align":"center",span:24}},[o("vxe-button",{attrs:{type:"reset"},on:{click:function(e){t.modalEditDisplay=!1}}},[t._v("取消")]),o("vxe-button",{attrs:{type:"submit",status:"primary"}},[t._v("提交")])],1)],1)],1),o("vxe-modal",{attrs:{title:"批量添加",width:"500",resize:"","destroy-on-close":""},model:{value:t.modalBatchDisplay,callback:function(e){t.modalBatchDisplay=e},expression:"modalBatchDisplay"}},[o("el-row",[t._v(" 第一步："),o("a",{staticStyle:{color:"blue"},attrs:{href:"/static/template.xlsx"}},[o("span",{staticStyle:{color:"blue"}},[t._v("点此下载模板。")])])]),o("el-row",[t._v(" 第二步：上传文件。 "),o("div",{staticStyle:{padding:"20px",width:"400px",margin:"0 auto"}},[o("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"http://192.168.1.223:8000/vue-element-admin/backend/upload_file/","auto-upload":!0,data:t.uploadData,"on-success":t.handleSuccess,"on-error":t.handleError,"before-upload":t.beforeUpload,"on-change":t.handleChange,multiple:""}},[o("i",{staticClass:"el-icon-upload"}),o("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),o("em",[t._v("点击上传")])])])],1)])],1),o("vxe-modal",{attrs:{title:t.title,width:"500",resize:"","destroy-on-close":""},model:{value:t.modalProcessDisplayBatch,callback:function(e){t.modalProcessDisplayBatch=e},expression:"modalProcessDisplayBatch"}},[o("el-checkbox-group",{model:{value:t.checkListBatch,callback:function(e){t.checkListBatch=e},expression:"checkListBatch"}},[o("el-checkbox",{attrs:{label:"切割"}}),o("el-checkbox",{attrs:{label:"折弯"}}),o("el-checkbox",{attrs:{label:"组装"}}),o("el-checkbox",{attrs:{label:"焊接"}}),o("el-checkbox",{attrs:{label:"验焊"}}),o("el-checkbox",{attrs:{label:"镀锌"}}),o("el-checkbox",{attrs:{label:"喷涂"}}),o("el-checkbox",{attrs:{label:"攻牙"}}),o("el-checkbox",{attrs:{label:"包装"}}),o("br"),o("el-checkbox",{attrs:{label:"其它"}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.other_process_batch,expression:"other_process_batch"}],staticClass:"underline-input",staticStyle:{"margin-left":"10px"},attrs:{type:"text",placeholder:"输入其他工艺"},domProps:{value:t.other_process_batch},on:{input:function(e){e.target.composing||(t.other_process_batch=e.target.value)}}})],1),o("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[o("el-button",{on:{click:function(e){return t.cancleProcessBatch()}}},[t._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addProcessBatch()}}},[t._v("添加")])],1)],1),o("vxe-modal",{attrs:{title:t.title,width:"800",resize:"","destroy-on-close":""},model:{value:t.editProcessDisplayBatch,callback:function(e){t.editProcessDisplayBatch=e},expression:"editProcessDisplayBatch"}},[o("vxe-grid",t._b({ref:"xGridExtra",scopedSlots:t._u([{key:"operation",fn:function(e){var i=e.row;return[o("div",{staticClass:"operation-container"},[o("span",[t._v("已完成："+t._s(i.process_quantity_total)+"件")]),o("slider",{attrs:{min:0,max:100,value:i.progress,row:i},on:{percentChange:t.handlePercentChange_Total},model:{value:i.progress,callback:function(e){t.$set(i,"progress",e)},expression:"row.progress"}})],1)]}},{key:"operation1",fn:function(e){var i=e.row;return[o("div",{staticClass:"operation-container"},[o("vxe-button",{attrs:{status:"danger"},on:{click:function(e){return t.deleteProcessRow(i)}}},[t._v("删除")])],1)]}},{key:"empty",fn:function(){return[o("span",{},[o("p",[t._v("没有数据！")])])]},proxy:!0}])},"vxe-grid",t.gridOptionsExtra_total,!1)),o("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[o("el-button",{on:{click:function(e){return t.cancleProcessBatch()}}},[t._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addProcessBatch()}}},[t._v("添加")])],1)],1),o("h3",[t._v("工艺列表（产品编号："+t._s(t.modalinfo.control_no)+" 订单数量："+t._s(t.modalinfo.commodity_quantity)+"）")]),o("vxe-toolbar",{scopedSlots:t._u([{key:"buttons",fn:function(){return[o("vxe-button",{attrs:{status:"primary"},on:{click:t.saveEvent}},[t._v("保存")])]},proxy:!0}])}),o("vxe-grid",t._b({ref:"xGridExtra",scopedSlots:t._u([{key:"operation",fn:function(e){var i=e.row;return[o("div",{staticClass:"operation-container"},[o("span",[t._v("已完成："+t._s(i.process_quantity)+"件")]),o("slider",{attrs:{min:0,max:100,value:i.progress,row:i},on:{percentChange:t.handlePercentChange},model:{value:i.progress,callback:function(e){t.$set(i,"progress",e)},expression:"row.progress"}})],1)]}},{key:"operation1",fn:function(e){var i=e.row;return[o("div",{staticClass:"operation-container"},[o("vxe-button",{attrs:{status:"danger"},on:{click:function(e){return t.deleteProcessRow(i)}}},[t._v("删除")])],1)]}},{key:"empty",fn:function(){return[o("span",{},[o("p",[t._v("没有数据！")])])]},proxy:!0}])},"vxe-grid",t.gridOptionsExtra,!1))],1)},a=[],s=o("c7eb"),r=o("1da1"),n=o("5530"),l=(o("a434"),o("b0c0"),o("d3b7"),o("159b"),o("a388")),c=o("d96b"),d=o("2f62"),m=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"slider",staticClass:"slider"},[o("div",{staticClass:"process",style:{width:t.width}}),o("div",{ref:"trunk",staticClass:"thunk",style:{left:t.left}},[o("div",{staticClass:"block"})])])},u=[],p={props:["min","max","row","value"],data:function(){return{slider:null,thunk:null,per:this.value}},computed:{scale:function(){return(this.per-this.min)/(this.max-this.min)},width:function(){return this.slider?this.slider.offsetWidth*this.scale+"px":"0px"},left:function(){return this.slider?this.slider.offsetWidth*this.scale-this.thunk.offsetWidth/2+"px":"0px"}},watch:{value:function(t){var e=this;e.per=t}},mounted:function(){this.slider=this.$refs.slider,this.thunk=this.$refs.trunk;var t=this;this.thunk.onmousedown=function(e){var o=parseInt(t.width),i=e.clientX;return document.onmousemove=function(e){var a=e.clientX-i+o,s=a/t.slider.offsetWidth;t.per=Math.ceil((t.max-t.min)*s+t.min),t.per=Math.max(t.per,t.min),t.per=Math.min(t.per,t.max),t.$emit("percentChange",t.per,t.row)},document.onmouseup=function(){document.onmousemove=document.onmouseup=null},!1}}},h=p,f=(o("89c2"),o("2877")),_=o("3b64"),v=o.n(_),b=Object(f["a"])(h,m,u,!1,null,null,null);"function"===typeof v.a&&v()(b);var x=b.exports,y={components:{slider:x},computed:Object(n["a"])({},Object(d["b"])(["sidebar","avatar","device","name"])),data:function(){var t=this;return{editProcessDisplayBatch:!1,totalProcessNameList:{},ProcessNameList:{},modalProcessDisplayBatch:!1,uploadData:{},modalBatchDisplay:!1,title:"",other_process:"",current_order_number:"",modalinfo:{},checkListBatch:[],checkList:[],modalProcessDisplay:!1,selectoptions:{},modalDisplay:!1,modalForm:{},modalEditDisplay:!1,modalEditForm:{},searchFormData:{},gridOptions:{resizable:!0,showOverflow:!0,border:"inner",rowId:"id",rowConfig:{isHover:!0},filterConfig:{remote:!0},pagerConfig:{pageSize:10,pageSizes:[10,50,100,500],layouts:["PrevJump","PrevPage","JumpNumber","NextPage","NextJump","Sizes","FullJump","Total"]},proxyConfig:{seq:!0,sort:!0,filter:!0,props:{list:"data",result:"data",total:"total"},ajax:{query:function(e){var o=e.page;e.sorts,e.filters;if(t.searchFormData.username=t.name,t.searchFormData.order_number){var i={action:"order_detail_table_view",subaction:"query",pageNum:o.currentPage,pageSize:o.pageSize,searchForm:t.searchFormData};return Object(c["a"])(i)}}}},formConfig:{titleWidth:100,titleAlign:"right",items:[{slots:{default:"search_buttons"}}]},toolbarConfig:{slots:{buttons:"toolbar_buttons"}},columns:[{type:"seq",title:"序号"},{type:"checkbox",field:"detailid",title:"选择"},{field:"commodity_details",title:"品名",sortable:!0},{field:"commodity_size",title:"规格",sortable:!0},{field:"control_no",title:"编号",sortable:!0},{field:"commodity_units",title:"单位"},{field:"commodity_quantity",title:"数量"},{field:"unit_weight",title:"单件重量"},{field:"commodity_weight",title:"重量"},{field:"remarks",title:"备注"},{title:"操作",showOverflow:!0,width:"360px",fixed:"right",slots:{default:"operation"}}]},gridOptionsExtra:{resizable:!0,showOverflow:!0,border:"inner",rowId:"id",rowConfig:{isHover:!0},editConfig:{trigger:"click",mode:"cell",showStatus:!0,enabled:!0,icon:"vxe-icon-edit"},keepSource:!0,data:[],columns:[{type:"seq",title:"序号"},{field:"processid",title:"ID",visible:!1},{field:"detailid_id",title:"产品编号",visible:!1},{field:"process_quantity",title:"当前完成数量",visible:!1},{field:"progress",title:"当前完成数量百分比",visible:!1},{field:"process_name",title:"工艺名称"},{title:"当前完成数量",slots:{default:"operation"}},{title:"操作",width:"200px",showOverflow:!0,fixed:"right",slots:{default:"operation1"}}]},gridOptionsExtra_total:{resizable:!0,showOverflow:!0,border:"inner",rowId:"id",rowConfig:{isHover:!0},editConfig:{trigger:"click",mode:"cell",showStatus:!0,enabled:!0,icon:"vxe-icon-edit"},keepSource:!0,data:[],columns:[{type:"seq",title:"序号",width:60},{field:"process_name",title:"工艺名称",width:100},{field:"commodity_quantity_total",title:"订单总数",width:100},{field:"process_quantity_total",title:"当前完成数量",width:100},{field:"progress",title:"当前完成数量百分比",visible:!1},{title:"当前完成数量",slots:{default:"operation"}}]},tableData:[],selectedRows:[]}},created:function(){},mounted:function(){this.getOptions(),this.current_order_number=this.$route.query.order_number,this.searchFormData.order_number=this.current_order_number,this.customer_name_id=this.$route.query.customer_name_id,this.searchFormData.customer_name_id=this.customer_name_id},methods:{handlePercentChange:function(t,e){console.log("百分比变化:",t),e.progress=t,console.log(this.modalinfo.commodity_quantity),e.process_quantity=Math.round(e.progress/100*this.modalinfo.commodity_quantity),console.log("百分比变化:",e.progress)},handlePercentChange_Total:function(t,e){console.log("百分比变化:",t),e.progress=t,console.log(e.commodity_quantity_total),e.process_quantity_total=Math.round(e.progress/100*e.commodity_quantity_total),console.log("百分比变化:",e.progress)},getSelectEventDelete:function(){var t=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){var e=t.$refs.xGrid.getCheckboxRecords(),o=[];e.forEach((function(t){o.push(t.detailid)}));var i={action:"production_process_table_view",subaction:"batchDelete",detailid_list:o};Object(c["a"])(i).then((function(e){l["VXETable"].modal.message({content:"删除成功",status:"success"}),t.$refs.xGrid.commitProxy("reload")}))}))},handleCheckboxChange:function(t){t.row,t.rowIndex,t.checked},cancleProcessBatch:function(){this.modalProcessDisplayBatch=!1},addProcessBatch:function(){var t=this,e=this.$refs.xGrid.getCheckboxRecords();""!==this.other_process_batch&&this.checkListBatch.push(this.other_process_batch);var o=[];e.forEach((function(t){o.push(t.detailid)}));var i={action:"production_process_table_view",subaction:"addProcessNameListBatch",detailid_list:o,process_list:this.checkListBatch,order_number_id:this.searchFormData.order_number};Object(c["a"])(i).then((function(e){l["VXETable"].modal.message({content:"添加工艺成功",status:"success"}),t.modalProcessDisplayBatch=!1}))},getProcessBatch:function(){var t=this;this.editProcessDisplayBatch=!0,console.log(this.checkListBatch);var e={action:"production_process_table_view",subaction:"getProcessNameListBatch",order_number_id:this.searchFormData.order_number};Object(c["a"])(e).then((function(e){t.gridOptionsExtra_total.data=e.data,console.log(t.gridOptionsExtra_total.data)}))},getSelectEvent:function(){this.modalProcessDisplayBatch=!0},getOptions:function(){var t=this,e={action:"order_detail_table_view",subaction:"getOptions"};Object(c["a"])(e).then((function(e){t.selectoptions=e.data}))},addRow:function(){this.modalForm={},this.modalDisplay=!0},modalSubmitEvent:function(){var t=this;console.log(this.modalForm),this.modalForm.order_number_id=this.searchFormData.order_number,this.modalForm.customer_name_id=this.searchFormData.customer_name_id,this.modalForm.commodity_weight=this.modalForm.unit_weight*this.modalForm.commodity_quantity,this.modalForm.username=this.name;var e={action:"order_detail_table_view",subaction:"addRecord",modalForm:this.modalForm};console.log(e),Object(c["a"])(e).then((function(e){t.modalDisplay=!1,l["VXETable"].modal.message({content:"提交成功",status:"success"}),t.$refs.xGrid.commitProxy("reload")}))},addRowBatch:function(){this.modalBatchDisplay=!0},deleteRow:function(t){var e=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){var o=e.$refs.xGrid.$data["tableData"];for(var i in o)t.id===o[i].id&&o.splice(i,1);var a={action:"order_detail_table_view",subaction:"deleteRecord",idmap:{detailid:t.detailid}};Object(c["a"])(a).then((function(t){l["VXETable"].modal.message({content:"删除成功",status:"success"}),e.$refs.xGrid.commitProxy("reload")}))}))},editRow:function(t){this.modalEditDisplay=!0,this.modalEditForm=t,this.modalEditForm.customer_name_id=this.customer_name_id;var e=o("2ef0");this.modalEditForm=e.cloneDeep(t),delete this.modalEditForm.id},modalEditSubmitEvent:function(){var t=this;this.modalEditForm.commodity_weight=this.modalEditForm.unit_weight*this.modalEditForm.commodity_quantity,this.modalEditForm.username=this.name;var e={action:"order_detail_table_view",subaction:"editRecord",modalEditForm:this.modalEditForm,idmap:{detailid:this.modalEditForm.detailid}};Object(c["a"])(e).then((function(e){t.modalEditDisplay=!1,l["VXETable"].modal.message({content:"提交成功",status:"success"}),t.$refs.xGrid.commitProxy("reload")}))},searchEvent:function(){this.$refs.xGrid.commitProxy("reload")},resetEvent:function(){this.searchFormData={},this.$refs.xGrid.commitProxy("reload")},getProcessList:function(t){var e=this;return Object(r["a"])(Object(s["a"])().mark((function o(){var i;return Object(s["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:i={action:"production_process_table_view",subaction:"getProcessList",detailid:t},Object(c["a"])(i).then((function(t){e.checkList=t.data}));case 2:case"end":return o.stop()}}),o)})))()},addProcessRow:function(t){var e=this;this.modalinfo.tmpdetailid=t.detailid,this.getProcessList(t.detailid).then((function(){e.other_process="",e.title="产品名称:"+t.commodity_details+" 产品编号:"+t.detailid,e.modalProcessDisplay=!0}))},addProcess:function(){var t=this;this.modalProcessDisplay=!1,""!==this.other_process&&this.checkList.push(this.other_process),console.log(this.checkList);var e={action:"production_process_table_view",subaction:"addProcessNameList",detailid:this.modalinfo.tmpdetailid,processList:this.checkList,order_number_id:this.searchFormData.order_number};Object(c["a"])(e).then((function(e){t.modalinfo.detailid=t.modalinfo.tmpdetailid,l["VXETable"].modal.message({content:"添加工艺成功",status:"success"}),t.getExtraData(t.modalinfo.detailid)}))},cancleProcess:function(){this.modalProcessDisplay=!1},deleteProcessRow:function(t){var e=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){var o=e.gridOptionsExtra.data;for(var i in o)t.id===o[i].id&&o.splice(i,1);var a={action:"production_process_table_view",subaction:"deleteRecord",idmap:{processid:t.processid}};Object(c["a"])(a).then((function(t){l["VXETable"].modal.message({content:"删除成功",status:"success"})}))}))},getExtraData:function(t,e){var o=this,i={action:"production_process_table_view",subaction:"query",pageNum:1,pageSize:50,searchForm:{detailid:t}};Object(c["a"])(i).then((function(t){o.gridOptionsExtra.data=t.data,console.log(o.gridOptionsExtra.data),o.gridOptionsExtra.data.forEach((function(t){t.progress=t.process_quantity/e*100})),console.log(o.gridOptionsExtra.data)}))},queryProcessRow:function(t){this.modalinfo.detailid=t.detailid,this.modalinfo.control_no=t.control_no,this.modalinfo.commodity_quantity=t.commodity_quantity,this.gridOptionsExtra.data={},this.getExtraData(t.detailid,t.commodity_quantity)},saveEvent:function(){var t=this,e=this.$refs.xGridExtra.getUpdateRecords(),o={action:"production_process_table_view",subaction:"updateMultiRecords",update_records:e,detailid:this.modalinfo.detailid};Object(c["a"])(o).then((function(e){l["VXETable"].modal.message({content:"修改成功",status:"success"}),t.getExtraData(t.modalinfo.detailid)}))},handleSuccess:function(t,e,o){window.location.reload(),this.$message.success("批量添加成功"),this.modalBatchDisplay=!1},handleError:function(t,e,o){console.log(t,e,o),this.$message.error("批量添加失败，请检查数据格式")},handleChange:function(t,e){console.log(t,e)},beforeUpload:function(t){var e=this;return this.uploadData={file_name:t.name,file_size:t.size,username:this.name,customer_name:this.searchFormData.customer_name_id,extra_data:"batch_add_products"},console.log(this.uploadData),new Promise((function(t){e.$nextTick((function(){t(!0)}))}))}}},g=y,k=(o("9cd6"),Object(f["a"])(g,i,a,!1,null,"ae6924e6",null));e["default"]=k.exports},"89c2":function(t,e,o){"use strict";o("f14c")},"9cd6":function(t,e,o){"use strict";o("ae88")},ae88:function(t,e,o){},d96b:function(t,e,o){"use strict";o.d(e,"a",(function(){return a})),o.d(e,"b",(function(){return s}));var i=o("b775");function a(t){return Object(i["a"])({url:"/vue-element-admin/backend/process/",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/vue-element-admin/backend/download_file/",method:"get",params:t})}},f14c:function(t,e,o){}}]);