(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a91257e"],{"1fc6":function(t,e,o){"use strict";o("c7e8")},"3b64":function(t,e){},"463b":function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticStyle:{padding:"0 50px 0 50px"}},[t.isDivVisible?[[o("el-row",{staticClass:"row-bg",attrs:{gutter:20,justify:"space-between"}},[o("el-col",{staticClass:"col-content",attrs:{span:16}},[o("vxe-grid",t._b({ref:"xGrid",on:{"checkbox-change":t.handleCheckboxChange},scopedSlots:t._u([{key:"search_buttons",fn:function(){return[o("h2",{staticClass:"align-bottom",staticStyle:{color:"black","padding-top":"20px"}},[t._v("订单号码："+t._s(t.searchFormData.order_number))])]},proxy:!0},{key:"toolbar_buttons",fn:function(){return[o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.addRow()}}},[t._v("添加产品")]),o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.addRowBatch()}}},[t._v("批量添加")]),o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.getSelectEvent()}}},[t._v("批量工艺")]),o("vxe-button",{attrs:{status:"warning"},on:{click:function(e){return t.getProcessBatch()}}},[t._v("批量进度")]),o("vxe-button",{attrs:{status:"danger"},on:{click:function(e){return t.getSelectEventDelete()}}},[t._v("批量删除")])]},proxy:!0},{key:"operation",fn:function(e){var i=e.row;return[o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.editRow(i)}}},[t._v("编辑")]),o("vxe-button",{attrs:{status:"danger"},on:{click:function(e){return t.deleteRow(i)}}},[t._v("删除")]),o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.addProcessRow(i)}}},[t._v("添加工艺")]),o("vxe-button",{attrs:{status:"primary"},on:{click:function(e){return t.queryProcessRow(i)}}},[t._v("查看工艺")])]}},{key:"empty",fn:function(){return[o("span",{},[o("p",[t._v("没有数据！")])])]},proxy:!0}],null,!1,367375352)},"vxe-grid",t.gridOptions,!1))],1),o("el-col",{staticClass:"col-content",attrs:{span:8}},[o("div",{staticClass:"align-bottom"},[o("h2",{staticStyle:{color:"black","padding-top":"20px"}},[t._v("生产进度")]),o("div",{ref:"chart",staticStyle:{width:"100%",height:"500px"}})])])],1)],o("vxe-modal",{attrs:{title:t.title,width:"500",resize:"","destroy-on-close":""},model:{value:t.modalProcessDisplay,callback:function(e){t.modalProcessDisplay=e},expression:"modalProcessDisplay"}},[o("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[o("el-checkbox",{attrs:{label:"切割"}}),o("el-checkbox",{attrs:{label:"折弯"}}),o("el-checkbox",{attrs:{label:"组装"}}),o("el-checkbox",{attrs:{label:"焊接"}}),o("el-checkbox",{attrs:{label:"验焊"}}),o("el-checkbox",{attrs:{label:"镀锌"}}),o("el-checkbox",{attrs:{label:"喷涂"}}),o("el-checkbox",{attrs:{label:"攻牙"}}),o("el-checkbox",{attrs:{label:"包装"}}),o("br"),o("el-checkbox",{attrs:{label:"其它"}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.other_process,expression:"other_process"}],staticClass:"underline-input",staticStyle:{"margin-left":"10px"},attrs:{type:"text",placeholder:"输入其他工艺"},domProps:{value:t.other_process},on:{input:function(e){e.target.composing||(t.other_process=e.target.value)}}})],1),o("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[o("el-button",{on:{click:function(e){return t.cancleProcess()}}},[t._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addProcess()}}},[t._v("添加")])],1)],1),o("vxe-modal",{attrs:{title:"新增",width:"500",resize:"","destroy-on-close":""},model:{value:t.modalDisplay,callback:function(e){t.modalDisplay=e},expression:"modalDisplay"}},[o("vxe-form",{attrs:{"title-align":"right","title-width":"100"},on:{submit:t.modalSubmitEvent}},[o("vxe-form-item",{attrs:{title:"订单号码",span:24}},[o("span",[t._v(t._s(t.searchFormData.order_number))])]),o("vxe-form-item",{attrs:{title:"品名",span:24}},[o("vxe-input",{model:{value:t.modalForm.commodity_details,callback:function(e){t.$set(t.modalForm,"commodity_details",e)},expression:"modalForm.commodity_details"}})],1),o("vxe-form-item",{attrs:{title:"规格",span:24}},[o("vxe-input",{model:{value:t.modalForm.commodity_size,callback:function(e){t.$set(t.modalForm,"commodity_size",e)},expression:"modalForm.commodity_size"}})],1),o("vxe-form-item",{attrs:{title:"编号",span:24}},[o("vxe-input",{model:{value:t.modalForm.control_no,callback:function(e){t.$set(t.modalForm,"control_no",e)},expression:"modalForm.control_no"}})],1),o("vxe-form-item",{attrs:{title:"单位",span:24}},[o("vxe-input",{model:{value:t.modalForm.commodity_units,callback:function(e){t.$set(t.modalForm,"commodity_units",e)},expression:"modalForm.commodity_units"}})],1),o("vxe-form-item",{attrs:{title:"数量",span:24}},[o("vxe-input",{model:{value:t.modalForm.commodity_quantity,callback:function(e){t.$set(t.modalForm,"commodity_quantity",e)},expression:"modalForm.commodity_quantity"}})],1),o("vxe-form-item",{attrs:{title:"单件重量",span:24}},[o("vxe-input",{model:{value:t.modalForm.unit_weight,callback:function(e){t.$set(t.modalForm,"unit_weight",e)},expression:"modalForm.unit_weight"}})],1),o("vxe-form-item",{attrs:{title:"备注",span:24}},[o("vxe-input",{model:{value:t.modalForm.remarks,callback:function(e){t.$set(t.modalForm,"remarks",e)},expression:"modalForm.remarks"}})],1),o("vxe-form-item",{attrs:{align:"center","title-align":"center",span:24}},[o("vxe-button",{attrs:{type:"reset"},on:{click:function(e){t.modalDisplay=!1}}},[t._v("取消")]),o("vxe-button",{attrs:{type:"submit",status:"primary"}},[t._v("提交")])],1)],1)],1),o("vxe-modal",{attrs:{title:"编辑",width:"500",resize:"","destroy-on-close":""},model:{value:t.modalEditDisplay,callback:function(e){t.modalEditDisplay=e},expression:"modalEditDisplay"}},[o("vxe-form",{attrs:{"title-align":"right","title-width":"100"},on:{submit:t.modalEditSubmitEvent}},[o("vxe-form-item",{attrs:{title:"订单号码",span:24}},[o("span",[t._v(t._s(t.searchFormData.order_number))])]),o("vxe-form-item",{attrs:{title:"品名",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.commodity_details,callback:function(e){t.$set(t.modalEditForm,"commodity_details",e)},expression:"modalEditForm.commodity_details"}})],1),o("vxe-form-item",{attrs:{title:"规格",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.commodity_size,callback:function(e){t.$set(t.modalEditForm,"commodity_size",e)},expression:"modalEditForm.commodity_size"}})],1),o("vxe-form-item",{attrs:{title:"编号",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.control_no,callback:function(e){t.$set(t.modalEditForm,"control_no",e)},expression:"modalEditForm.control_no"}})],1),o("vxe-form-item",{attrs:{title:"单位",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.commodity_units,callback:function(e){t.$set(t.modalEditForm,"commodity_units",e)},expression:"modalEditForm.commodity_units"}})],1),o("vxe-form-item",{attrs:{title:"数量",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.commodity_quantity,callback:function(e){t.$set(t.modalEditForm,"commodity_quantity",e)},expression:"modalEditForm.commodity_quantity"}})],1),o("vxe-form-item",{attrs:{title:"单件重量",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.unit_weight,callback:function(e){t.$set(t.modalEditForm,"unit_weight",e)},expression:"modalEditForm.unit_weight"}})],1),o("vxe-form-item",{attrs:{title:"备注",span:24}},[o("vxe-input",{model:{value:t.modalEditForm.remarks,callback:function(e){t.$set(t.modalEditForm,"remarks",e)},expression:"modalEditForm.remarks"}})],1),o("vxe-form-item",{attrs:{align:"center","title-align":"center",span:24}},[o("vxe-button",{attrs:{type:"reset"},on:{click:function(e){t.modalEditDisplay=!1}}},[t._v("取消")]),o("vxe-button",{attrs:{type:"submit",status:"primary"}},[t._v("提交")])],1)],1)],1),o("vxe-modal",{attrs:{title:"批量添加",width:"500",resize:"","destroy-on-close":""},model:{value:t.modalBatchDisplay,callback:function(e){t.modalBatchDisplay=e},expression:"modalBatchDisplay"}},[o("el-row",[t._v(" 第一步："),o("a",{staticStyle:{color:"blue"},attrs:{href:"/static/template.xlsx"}},[o("span",{staticStyle:{color:"blue"}},[t._v("点此下载模板。")])])]),o("el-row",[t._v(" 第二步：上传文件。 "),o("div",{staticStyle:{padding:"20px",width:"400px",margin:"0 auto"}},[o("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"http://192.168.1.212:8000/vue-element-admin/backend/upload_file/","auto-upload":!0,data:t.uploadData,"on-success":t.handleSuccess,"on-error":t.handleError,"before-upload":t.beforeUpload,"on-change":t.handleChange,multiple:""}},[o("i",{staticClass:"el-icon-upload"}),o("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),o("em",[t._v("点击上传")])])])],1)])],1),o("vxe-modal",{attrs:{title:t.title,width:"500",resize:"","destroy-on-close":""},model:{value:t.modalProcessDisplayBatch,callback:function(e){t.modalProcessDisplayBatch=e},expression:"modalProcessDisplayBatch"}},[o("el-checkbox-group",{model:{value:t.checkListBatch,callback:function(e){t.checkListBatch=e},expression:"checkListBatch"}},[o("el-checkbox",{attrs:{label:"切割"}}),o("el-checkbox",{attrs:{label:"折弯"}}),o("el-checkbox",{attrs:{label:"组装"}}),o("el-checkbox",{attrs:{label:"焊接"}}),o("el-checkbox",{attrs:{label:"验焊"}}),o("el-checkbox",{attrs:{label:"镀锌"}}),o("el-checkbox",{attrs:{label:"喷涂"}}),o("el-checkbox",{attrs:{label:"攻牙"}}),o("el-checkbox",{attrs:{label:"包装"}}),o("br"),o("el-checkbox",{attrs:{label:"其它"}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.other_process_batch,expression:"other_process_batch"}],staticClass:"underline-input",staticStyle:{"margin-left":"10px"},attrs:{type:"text",placeholder:"输入其他工艺"},domProps:{value:t.other_process_batch},on:{input:function(e){e.target.composing||(t.other_process_batch=e.target.value)}}})],1),o("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[o("el-button",{on:{click:function(e){return t.cancleProcessBatch()}}},[t._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addProcessBatch()}}},[t._v("添加")])],1)],1),o("vxe-modal",{attrs:{title:t.title,width:"800",resize:"","destroy-on-close":""},model:{value:t.editProcessDisplayBatch,callback:function(e){t.editProcessDisplayBatch=e},expression:"editProcessDisplayBatch"}},[o("vxe-grid",t._b({ref:"xGridExtra",staticStyle:{width:"95%"},scopedSlots:t._u([{key:"operation",fn:function(e){var i=e.row;return[o("div",{staticClass:"operation-container"},[o("span",[t._v("已完成："+t._s(i.total_process_quantity)+"件")]),o("slider",{attrs:{min:0,max:100,value:i.progress,row:i},on:{percentChange:t.handlePercentChange_Total},model:{value:i.progress,callback:function(e){t.$set(i,"progress",e)},expression:"row.progress"}})],1)]}},{key:"empty",fn:function(){return[o("span",{},[o("p",[t._v("没有数据！")])])]},proxy:!0}],null,!1,646719644)},"vxe-grid",t.gridOptionsExtra_total,!1)),o("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[o("el-button",{on:{click:function(e){return t.cancleProcessTotalBatch()}}},[t._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addProcessTotalBatch()}}},[t._v("提交")])],1)],1),o("vxe-modal",{attrs:{title:"工艺列表",width:"700",resize:"","destroy-on-close":""},model:{value:t.ProcessModalView,callback:function(e){t.ProcessModalView=e},expression:"ProcessModalView"}},[o("h3",[t._v("产品编号："+t._s(t.modalinfo.control_no)+" 订单数量："+t._s(t.modalinfo.commodity_quantity))]),o("vxe-toolbar",{scopedSlots:t._u([{key:"buttons",fn:function(){return[o("vxe-button",{attrs:{status:"primary"},on:{click:t.saveEvent}},[t._v("保存")])]},proxy:!0}],null,!1,667893510)}),o("vxe-grid",t._b({ref:"xGridExtra",scopedSlots:t._u([{key:"operation",fn:function(e){var i=e.row;return[o("div",{staticClass:"operation-container"},[o("span",[t._v("已完成："+t._s(i.process_quantity)+"件")]),o("slider",{attrs:{min:0,max:100,value:i.progress,row:i},on:{percentChange:t.handlePercentChange},model:{value:i.progress,callback:function(e){t.$set(i,"progress",e)},expression:"row.progress"}})],1)]}},{key:"operation1",fn:function(e){var i=e.row;return[o("div",{staticClass:"operation-container"},[o("vxe-button",{attrs:{status:"danger"},on:{click:function(e){return t.deleteProcessRow(i)}}},[t._v("删除")])],1)]}},{key:"empty",fn:function(){return[o("span",{},[o("p",[t._v("没有数据！")])])]},proxy:!0}],null,!1,3555041333)},"vxe-grid",t.gridOptionsExtra,!1))],1)]:t._e(),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.isDivVisible,expression:"!isDivVisible"}]},[o("h4",[t._v("提示：请先到订单管理页选择要操作的订单。")])])],2)},a=[],s=o("c7eb"),r=o("1da1"),n=o("5530"),c=(o("d81d"),o("a434"),o("b0c0"),o("d3b7"),o("0643"),o("4e3e"),o("a573"),o("159b"),o("a388")),l=o("d96b"),d=o("2f62"),m=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"slider",staticClass:"slider"},[o("div",{staticClass:"process",style:{width:t.width}}),o("div",{ref:"trunk",staticClass:"thunk",style:{left:t.left}},[o("div",{staticClass:"block"})])])},u=[],h={props:["min","max","row","value"],data:function(){return{slider:null,thunk:null,per:this.value}},computed:{scale:function(){return(this.per-this.min)/(this.max-this.min)},width:function(){return this.slider?this.slider.offsetWidth*this.scale+"px":"0px"},left:function(){return this.slider?this.slider.offsetWidth*this.scale-this.thunk.offsetWidth/2+"px":"0px"}},watch:{value:function(t){var e=this;e.per=t}},mounted:function(){this.slider=this.$refs.slider,this.thunk=this.$refs.trunk;var t=this;this.thunk.onmousedown=function(e){var o=parseInt(t.width),i=e.clientX;return document.onmousemove=function(e){var a=e.clientX-i+o,s=a/t.slider.offsetWidth;t.per=Math.ceil((t.max-t.min)*s+t.min),t.per=Math.max(t.per,t.min),t.per=Math.min(t.per,t.max),t.$emit("percentChange",t.per,t.row)},document.onmouseup=function(){document.onmousemove=document.onmouseup=null},!1}}},p=h,f=(o("89c2"),o("2877")),b=o("3b64"),_=o.n(b),v=Object(f["a"])(p,m,u,!1,null,null,null);"function"===typeof _.a&&_()(v);var g=v.exports,x=o("313e"),y={components:{slider:g},computed:Object(n["a"])({},Object(d["b"])(["sidebar","avatar","device","name"])),data:function(){var t=this;return{isDivVisible:!1,ProcessModalView:!1,editProcessDisplayBatch:!1,totalProcessNameList:{},ProcessNameList:{},modalProcessDisplayBatch:!1,uploadData:{},modalBatchDisplay:!1,title:"",other_process:"",current_order_number:"",modalinfo:{},checkListBatch:[],checkList:[],modalProcessDisplay:!1,selectoptions:{},modalDisplay:!1,modalForm:{},modalEditDisplay:!1,modalEditForm:{},searchFormData:{},gridOptions:{resizable:!0,showOverflow:!0,height:1100,border:"inner",rowId:"id",rowConfig:{isHover:!0},filterConfig:{remote:!0},pagerConfig:{pageSize:500,pageSizes:[500,1e3,5e3],layouts:["PrevJump","PrevPage","JumpNumber","NextPage","NextJump","Sizes","FullJump","Total"]},checkboxConfig:{highlight:!0,range:!0,trigger:"row"},proxyConfig:{seq:!0,sort:!0,filter:!0,props:{list:"data",result:"data",total:"total"},ajax:{query:function(e){var o=e.page;e.sorts,e.filters;if(t.searchFormData.username=t.name,t.searchFormData.order_number){var i={action:"order_detail_table_view",subaction:"query",pageNum:o.currentPage,pageSize:o.pageSize,searchForm:t.searchFormData};return Object(l["b"])(i).then((function(e){return t.getFullProcessBatch(e.data),{data:e.data,total:e.total}}))}}}},formConfig:{titleWidth:100,titleAlign:"right",items:[{slots:{default:"search_buttons"}}]},toolbarConfig:{slots:{buttons:"toolbar_buttons"}},columns:[{type:"seq",title:"序号",width:60,align:"center"},{type:"checkbox",field:"detailid",title:"选择",align:"center"},{field:"commodity_details",title:"品名",sortable:!0,align:"center"},{field:"commodity_size",title:"规格",sortable:!0,align:"center"},{field:"control_no",title:"编号",sortable:!0,align:"center"},{field:"commodity_units",title:"单位",align:"center"},{field:"commodity_quantity",title:"库存数量",align:"center"},{field:"total_shipping_quantity",title:"已出货数量",align:"center"},{field:"unit_weight",title:"单件重量",align:"center"},{field:"commodity_weight",title:"重量",align:"center"},{field:"remarks",title:"备注",align:"center"},{title:"操作",showOverflow:!0,width:"360px",fixed:"right",slots:{default:"operation"},align:"center"}]},gridOptionsExtra:{resizable:!0,showOverflow:!0,border:"inner",rowId:"id",rowConfig:{isHover:!0},editConfig:{trigger:"click",mode:"cell",showStatus:!0,enabled:!0,icon:"vxe-icon-edit"},keepSource:!0,data:[],columns:[{type:"seq",title:"序号",width:100},{field:"processid",title:"ID",visible:!1},{field:"detailid_id",title:"产品编号",visible:!1},{field:"process_quantity",title:"当前完成数量",visible:!1},{field:"progress",title:"当前完成数量百分比",visible:!1},{field:"process_name",title:"工艺名称",width:100},{title:"当前完成数量",slots:{default:"operation"}},{title:"操作",width:"160px",showOverflow:!0,fixed:"right",slots:{default:"operation1"}}]},gridOptionsExtra_total:{resizable:!0,showOverflow:!0,border:"inner",rowId:"id",rowConfig:{isHover:!0},editConfig:{trigger:"click",mode:"cell",showStatus:!0,enabled:!0,icon:"vxe-icon-edit"},keepSource:!0,data:[],columns:[{type:"seq",title:"序号",width:60},{field:"process_name",title:"工艺名称",width:100},{field:"total_commodity_quantity",title:"订单总数",width:100},{field:"total_process_quantity",title:"当前完成数量",editRender:{name:"input"},width:100},{field:"progress",title:"当前完成数量百分比",visible:!1},{title:"当前完成数量",slots:{default:"operation"}}]},detailid_list:[],isCheck_list:[],tableData:[],selectedRows:[]}},created:function(){},mounted:function(){this.getOptions(),this.current_order_number=this.$route.query.order_number,void 0===this.current_order_number?(this.current_order_number="",this.isDivVisible=!1):this.isDivVisible=!0,this.searchFormData.order_number=this.current_order_number,this.customer_name_id=this.$route.query.customer_name_id,this.searchFormData.customer_name_id=this.customer_name_id},methods:{initChart:function(t){var e=x["init"](this.$refs.chart),o=t.map((function(t){return t.process_name})),i=t.map((function(t){return t.total_commodity_quantity})),a=t.map((function(t){return t.total_process_quantity})),s={tooltip:{trigger:"axis"},legend:{data:["订单数量","完成数量"]},xAxis:{type:"category",data:o},yAxis:{type:"value"},series:[{name:"订单数量",type:"bar",data:i,barWidth:20,itemStyle:{color:"#C0C4CC"},label:{show:!0,position:"top",formatter:"{c}"}},{name:"完成数量",type:"bar",data:a,barWidth:20,itemStyle:{color:"#409EFF"},label:{show:!0,position:"top",formatter:"{c}"}}]};e.setOption(s)},getFullProcessBatch:function(t){var e=this,o=t.map((function(t){return t["detailid"]}));if(console.log(o),0!==o.length){var i={action:"production_process_table_view",subaction:"getProcessNameListBatch",detailid_list:o};Object(l["b"])(i).then((function(t){e.initChart(t.data)}))}},handlePercentChange:function(t,e){e.progress=t,console.log(e.progress),e.process_quantity=Math.round(e.progress/100*this.modalinfo.commodity_quantity)},handlePercentChange_Total:function(t,e){e.progress=t,e.total_process_quantity=Math.round(e.progress/100*e.total_commodity_quantity)},getSelectEventDelete:function(){var t=this,e=this.$refs.xGrid.getCheckboxRecords();e.length?this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){var o=[];e.forEach((function(t){o.push(t.detailid)}));var i={action:"production_process_table_view",subaction:"batchDelete",detailid_list:o};Object(l["b"])(i).then((function(e){c["VXETable"].modal.message({content:"删除成功",status:"success"}),t.$refs.xGrid.commitProxy("reload")}))})):c["VXETable"].modal.message({content:"请先勾选要批量处理的行",status:"warning"})},handleCheckboxChange:function(t){t.row,t.rowIndex,t.checked},cancleProcessBatch:function(){this.modalProcessDisplayBatch=!1},cancleProcessTotalBatch:function(){this.editProcessDisplayBatch=!1},addProcessTotalBatch:function(){var t=this,e=this.gridOptionsExtra_total.data.map((function(e){return Object(n["a"])(Object(n["a"])({},e),{},{detailids:t.detailid_list})}));this.gridOptionsExtra_total.data=e,console.log(this.gridOptionsExtra_total.data);var o={action:"production_process_table_view",subaction:"update_process_quantity_view",data:this.gridOptionsExtra_total.data};Object(l["b"])(o).then((function(e){t.editProcessDisplayBatch=!1,c["VXETable"].modal.message({content:"提交成功",status:"success"}),t.getFullProcessBatch(t.$refs.xGrid.getTableData().fullData)}))},addProcessBatch:function(){var t=this,e={action:"production_process_table_view",subaction:"addProcessNameListBatch",detailid_list:this.isCheck_list,process_list:this.checkListBatch,order_number_id:this.searchFormData.order_number};Object(l["b"])(e).then((function(e){c["VXETable"].modal.message({content:"添加工艺成功",status:"success"}),t.modalProcessDisplayBatch=!1,t.getFullProcessBatch(t.$refs.xGrid.getTableData().fullData)}))},getProcessBatch:function(){var t=this,e=this.$refs.xGrid.getCheckboxRecords();if(e.length){""!==this.other_process_batch&&this.checkListBatch.push(this.other_process_batch),this.detailid_list=[],e.forEach((function(e){t.detailid_list.push(e.detailid)})),this.editProcessDisplayBatch=!0;var o={action:"production_process_table_view",subaction:"getProcessNameListBatch",detailid_list:this.detailid_list};Object(l["b"])(o).then((function(e){t.gridOptionsExtra_total.data=e.data,t.gridOptionsExtra_total.data.forEach((function(t){t.progress=t.total_process_quantity/t.total_commodity_quantity*100}))}))}else c["VXETable"].modal.message({content:"请先勾选要批量处理的行",status:"warning"})},getdetailList:function(){var t=this;return Object(r["a"])(Object(s["a"])().mark((function e(){var o;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=t.$refs.xGrid.getCheckboxRecords(),console.log(111),""!==t.other_process_batch&&t.checkListBatch.push(t.other_process_batch),t.isCheck_list=[],o.forEach((function(e){t.isCheck_list.push(e.detailid)})),console.log(t.isCheck_list);case 6:case"end":return e.stop()}}),e)})))()},getSelectEvent:function(){var t=this.$refs.xGrid.getCheckboxRecords();t.length?(this.getdetailList(),this.getProcessListBath(this.isCheck_list),this.modalProcessDisplayBatch=!0):c["VXETable"].modal.message({content:"请先勾选要批量处理的行",status:"warning"})},getOptions:function(){var t=this,e={action:"order_detail_table_view",subaction:"getOptions"};Object(l["b"])(e).then((function(e){t.selectoptions=e.data}))},addRow:function(){this.modalForm={},this.modalDisplay=!0},modalSubmitEvent:function(){var t=this;console.log(this.modalForm),this.modalForm.order_number_id=this.searchFormData.order_number,this.modalForm.customer_name_id=this.searchFormData.customer_name_id,this.modalForm.commodity_weight=this.modalForm.unit_weight*this.modalForm.commodity_quantity,this.modalForm.username=this.name;var e={action:"order_detail_table_view",subaction:"addRecord",modalForm:this.modalForm};console.log(e),Object(l["b"])(e).then((function(e){t.modalDisplay=!1,c["VXETable"].modal.message({content:"提交成功",status:"success"}),t.$refs.xGrid.commitProxy("reload")}))},addRowBatch:function(){this.modalBatchDisplay=!0},deleteRow:function(t){var e=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){var o=e.$refs.xGrid.$data["tableData"];for(var i in o)t.id===o[i].id&&o.splice(i,1);var a={action:"order_detail_table_view",subaction:"deleteRecord",idmap:{detailid:t.detailid}};Object(l["b"])(a).then((function(t){c["VXETable"].modal.message({content:"删除成功",status:"success"}),e.$refs.xGrid.commitProxy("reload")}))}))},editRow:function(t){this.modalEditDisplay=!0,this.modalEditForm=t,this.modalEditForm.customer_name_id=this.customer_name_id;var e=o("2ef0");this.modalEditForm=e.cloneDeep(t),delete this.modalEditForm.id},modalEditSubmitEvent:function(){var t=this;this.modalEditForm.commodity_weight=this.modalEditForm.unit_weight*this.modalEditForm.commodity_quantity,this.modalEditForm.username=this.name;var e={action:"order_detail_table_view",subaction:"editRecord",modalEditForm:this.modalEditForm,idmap:{detailid:this.modalEditForm.detailid}};Object(l["b"])(e).then((function(e){t.modalEditDisplay=!1,c["VXETable"].modal.message({content:"提交成功",status:"success"}),t.$refs.xGrid.commitProxy("reload")}))},searchEvent:function(){this.$refs.xGrid.commitProxy("reload")},resetEvent:function(){this.searchFormData={},this.$refs.xGrid.commitProxy("reload")},getProcessListBath:function(){var t=this;return Object(r["a"])(Object(s["a"])().mark((function e(){var o;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:o={action:"production_process_table_view",subaction:"getProcessListBath",detailid_list:t.isCheck_list},Object(l["b"])(o).then((function(e){console.log(e.data),t.checkListBatch=e.data}));case 2:case"end":return e.stop()}}),e)})))()},getProcessList:function(t){var e=this;return Object(r["a"])(Object(s["a"])().mark((function o(){var i;return Object(s["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:i={action:"production_process_table_view",subaction:"getProcessList",detailid:t},Object(l["b"])(i).then((function(t){e.checkList=t.data}));case 2:case"end":return o.stop()}}),o)})))()},addProcessRow:function(t){var e=this;this.modalinfo.tmpdetailid=t.detailid,this.getProcessList(t.detailid).then((function(){e.other_process="",e.title="产品名称:"+t.commodity_details+" 产品编号:"+t.detailid,e.modalProcessDisplay=!0}))},addProcess:function(){var t=this;this.modalProcessDisplay=!1,""!==this.other_process&&this.checkList.push(this.other_process),console.log(this.checkList);var e={action:"production_process_table_view",subaction:"addProcessNameList",detailid:this.modalinfo.tmpdetailid,processList:this.checkList};Object(l["b"])(e).then((function(e){t.modalinfo.detailid=t.modalinfo.tmpdetailid,c["VXETable"].modal.message({content:"添加工艺成功",status:"success"}),t.getExtraData(t.modalinfo.detailid),t.getFullProcessBatch(t.$refs.xGrid.getTableData().fullData)}))},cancleProcess:function(){this.modalProcessDisplay=!1},deleteProcessRow:function(t){var e=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){var o=e.gridOptionsExtra.data;for(var i in o)t.id===o[i].id&&o.splice(i,1);var a={action:"production_process_table_view",subaction:"deleteRecord",idmap:{processid:t.processid}};Object(l["b"])(a).then((function(t){c["VXETable"].modal.message({content:"删除成功",status:"success"}),e.getFullProcessBatch(e.$refs.xGrid.getTableData().fullData)}))}))},getExtraData:function(t,e){var o=this,i={action:"production_process_table_view",subaction:"query",pageNum:1,pageSize:50,searchForm:{detailid:t}};Object(l["b"])(i).then((function(t){o.gridOptionsExtra.data=t.data,o.gridOptionsExtra.data.forEach((function(t){t.progress=t.process_quantity/e*100}))}))},queryProcessRow:function(t){this.ProcessModalView=!0,this.modalinfo.detailid=t.detailid,this.modalinfo.control_no=t.control_no,this.modalinfo.commodity_quantity=t.commodity_quantity,this.gridOptionsExtra.data={},this.getExtraData(t.detailid,t.commodity_quantity)},saveEvent:function(){var t=this,e=this.$refs.xGridExtra.getUpdateRecords(),o={action:"production_process_table_view",subaction:"updateMultiRecords",update_records:e,detailid:this.modalinfo.detailid};Object(l["b"])(o).then((function(e){c["VXETable"].modal.message({content:"修改成功",status:"success"}),t.getFullProcessBatch(t.$refs.xGrid.getTableData().fullData),t.gridOptionsExtra.data.forEach((function(e){e.progress=e.process_quantity/t.modalinfo.commodity_quantity*100}))}))},handleSuccess:function(t,e,o){window.location.reload(),this.$message.success("批量添加成功"),this.modalBatchDisplay=!1},handleError:function(t,e,o){console.log(t,e,o),this.$message.error("批量添加失败，请检查数据格式")},handleChange:function(t,e){console.log(t,e)},beforeUpload:function(t){var e=this;return this.uploadData={file_name:t.name,file_size:t.size,username:this.name,order_number:this.current_order_number,customer_name:this.searchFormData.customer_name_id,extra_data:"batch_add_products"},console.log(this.uploadData),new Promise((function(t){e.$nextTick((function(){t(!0)}))}))}}},w=y,k=(o("1fc6"),Object(f["a"])(w,i,a,!1,null,"53cbf3da",null));e["default"]=k.exports},"89c2":function(t,e,o){"use strict";o("f14c")},c7e8:function(t,e,o){},d96b:function(t,e,o){"use strict";o.d(e,"b",(function(){return s})),o.d(e,"c",(function(){return r})),o.d(e,"a",(function(){return n}));var i=o("5530"),a=o("b775");function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(a["a"])(Object(i["a"])({url:"".concat("","/vue-element-admin/backend/process/"),method:"post",data:t,timeout:5e3},e))}function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(a["a"])(Object(i["a"])({url:"".concat("","/vue-element-admin/backend/download_file/"),method:"get",params:t,responseType:"blob",timeout:0},e))}function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(a["a"])(Object(i["a"])({url:"/vue-element-admin/backend/process/",method:"post",data:t,responseType:"blob",noCodeCheck:!0,timeout:0},e))}},f14c:function(t,e,o){}}]);