(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ca5e635"],{"7db0":function(e,t,a){"use strict";var n=a("23e7"),i=a("b727").find,r=a("44d2"),o=a("ae40"),s="find",c=!0,l=o(s);s in[]&&Array(1)[s]((function(){c=!1})),n({target:"Array",proto:!0,forced:c||!l},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(s)},a74c:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"0 50px 0 50px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isDivVisible,expression:"isDivVisible"}]},[a("vxe-toolbar",{scopedSlots:e._u([{key:"buttons",fn:function(){return[a("vxe-button",{attrs:{icon:"vxe-icon-square-plus",status:"primary"},on:{click:e.addProductEvent}},[e._v("添加产品")]),a("vxe-button",{attrs:{icon:"vxe-icon-save",status:"primary"},on:{click:e.saveEvent}},[e._v("保存")])]},proxy:!0}])}),a("vxe-form",{staticStyle:{"margin-left":"-10px"},attrs:{"title-align":"right","title-width":"100"}},[a("vxe-form-item",{attrs:{title:"客户名称",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[a("vxe-select",{attrs:{placeholder:"请搜索",options:e.shipping_options.customer_name_options,clearable:"",filterable:""},on:{change:e.getProductList},model:{value:e.modalForm.customer_name,callback:function(t){e.$set(e.modalForm,"customer_name",t)},expression:"modalForm.customer_name"}})]},proxy:!0}])}),a("vxe-form-item",{attrs:{title:"出货日期",span:5}},[a("vxe-input",{ref:"datainpnt",attrs:{type:"date",placeholder:"请选择日期",clearable:""},model:{value:e.modalForm.delivery_date,callback:function(t){e.$set(e.modalForm,"delivery_date",t)},expression:"modalForm.delivery_date"}})],1),a("vxe-form-item",{attrs:{title:"收货地址",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[a("vxe-select",{attrs:{placeholder:"请搜索",options:e.shipping_options.shipping_address_options,clearable:"",filterable:""},on:{change:e.getProjectInfo},model:{value:e.modalForm.shipping_address,callback:function(t){e.$set(e.modalForm,"shipping_address",t)},expression:"modalForm.shipping_address"}})]},proxy:!0}])}),a("vxe-form-item",{attrs:{title:"司机",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[a("vxe-select",{attrs:{placeholder:"请搜索",options:e.shipping_options.driver_name_options,clearable:"",filterable:""},on:{change:e.getDriverInfo},model:{value:e.modalForm.driver_name,callback:function(t){e.$set(e.modalForm,"driver_name",t)},expression:"modalForm.driver_name"}})]},proxy:!0}])}),a("vxe-form-item",{attrs:{title:"发货人",span:4},scopedSlots:e._u([{key:"default",fn:function(){return[a("vxe-select",{attrs:{placeholder:"请搜索",options:e.shipping_options.username_options,clearable:"",filterable:""},model:{value:e.modalForm.username,callback:function(t){e.$set(e.modalForm,"username",t)},expression:"modalForm.username"}})]},proxy:!0}])})],1),a("vxe-form",{staticStyle:{"margin-left":"-10px"},attrs:{"title-align":"right","title-width":"100"}},[a("vxe-form-item",{attrs:{title:"收货人",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[a("vxe-input",{attrs:{placeholder:"",disabled:""},model:{value:e.modalForm.project_contact_name,callback:function(t){e.$set(e.modalForm,"project_contact_name",t)},expression:"modalForm.project_contact_name"}})]},proxy:!0}])}),a("vxe-form-item",{attrs:{title:"收货联系方式",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[a("vxe-input",{attrs:{placeholder:"",disabled:""},model:{value:e.modalForm.project_contact_phone,callback:function(t){e.$set(e.modalForm,"project_contact_phone",t)},expression:"modalForm.project_contact_phone"}})]},proxy:!0}])}),a("vxe-form-item",{attrs:{title:"车牌",span:5},scopedSlots:e._u([{key:"default",fn:function(){return[a("vxe-input",{attrs:{placeholder:"",disabled:""},model:{value:e.modalForm.licence_plate,callback:function(t){e.$set(e.modalForm,"licence_plate",t)},expression:"modalForm.licence_plate"}})]},proxy:!0}])})],1),a("vxe-table",{ref:"xTable",attrs:{border:"","show-overflow":"","keep-source":"","max-height":"400",data:e.shiptableData,"edit-config":{trigger:"click",mode:"cell",icon:"vxe-icon-edit",showStatus:!0}}},[a("vxe-column",{attrs:{type:"seq",width:"60",title:"序号"}}),a("vxe-column",{attrs:{field:"detailid",title:"产品ID",visible:!1},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("vxe-input",{attrs:{type:"text"},model:{value:n.detailid,callback:function(t){e.$set(n,"detailid",t)},expression:"row.detailid"}})]}}])}),a("vxe-column",{attrs:{field:"order_number_id",title:"订单号码"},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("vxe-input",{attrs:{type:"text"},model:{value:n.order_number_id,callback:function(t){e.$set(n,"order_number_id",t)},expression:"row.order_number_id"}})]}}])}),a("vxe-column",{attrs:{field:"commodity_details",title:"品名"},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("vxe-input",{attrs:{type:"text"},model:{value:n.commodity_details,callback:function(t){e.$set(n,"commodity_details",t)},expression:"row.commodity_details"}})]}}])}),a("vxe-column",{attrs:{field:"commodity_size",title:"规格"},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("vxe-input",{attrs:{type:"text"},model:{value:n.commodity_size,callback:function(t){e.$set(n,"commodity_size",t)},expression:"row.commodity_size"}})]}}])}),a("vxe-column",{attrs:{field:"control_no",title:"编号"},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("vxe-input",{attrs:{type:"text"},model:{value:n.control_no,callback:function(t){e.$set(n,"control_no",t)},expression:"row.control_no"}})]}}])}),a("vxe-column",{attrs:{field:"commodity_units",title:"单位"},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("vxe-input",{attrs:{type:"text"},model:{value:n.commodity_units,callback:function(t){e.$set(n,"commodity_units",t)},expression:"row.commodity_units"}})]}}])}),a("vxe-column",{attrs:{field:"shipping_quantity",title:"发货数量","edit-render":{autofocus:".vxe-input--inner",defaultValue:"0"}},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("vxe-input",{attrs:{type:"text"},on:{change:function(t){return e.handleChange(n)}},nativeOn:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnterUp(n)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.onDownUp(n)}]},model:{value:n.shipping_quantity,callback:function(t){e.$set(n,"shipping_quantity",t)},expression:"row.shipping_quantity"}})]}}])}),a("vxe-column",{attrs:{field:"shipping_weight",title:"发货重量"},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("vxe-input",{attrs:{type:"text"},model:{value:n.shipping_weight,callback:function(t){e.$set(n,"shipping_weight",t)},expression:"row.shipping_weight"}})]}}])}),a("vxe-column",{attrs:{field:"unit_weight",title:"单件重量"},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("vxe-input",{attrs:{type:"text"},model:{value:n.unit_weight,callback:function(t){e.$set(n,"unit_weight",t)},expression:"row.unit_weight"}})]}}])}),a("vxe-column",{attrs:{field:"commodity_quantity",title:"库存数量"},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("vxe-input",{attrs:{type:"text"},model:{value:n.commodity_quantity,callback:function(t){e.$set(n,"commodity_quantity",t)},expression:"row.commodity_quantity"}})]}}])}),a("vxe-column",{attrs:{field:"remarks",title:"备注"},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("vxe-input",{attrs:{type:"text"},model:{value:n.remarks,callback:function(t){e.$set(n,"remarks",t)},expression:"row.remarks"}})]}}])}),a("vxe-column",{attrs:{title:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("vxe-button",{attrs:{status:"danger",content:"删除"},on:{click:function(t){return e.deleteRowEvent(n)}}})]}}])})],1),a("vxe-modal",{attrs:{title:"选择产品",width:"800",resize:"","destroy-on-close":""},model:{value:e.modalDisplay,callback:function(t){e.modalDisplay=t},expression:"modalDisplay"}},[a("div",{staticStyle:{"text-align":"center","margin-top":"10px","margin-bottom":"10px"}},[a("vxe-input",{attrs:{placeholder:"请输入订单号码"},model:{value:e.searchOrderNumber,callback:function(t){e.searchOrderNumber=t},expression:"searchOrderNumber"}}),a("vxe-button",{attrs:{status:"primary",content:"搜索"},on:{click:e.searchProductBtn}})],1),a("vxe-table",{ref:"xTableOrders",attrs:{data:e.tableData,"checkbox-config":{checkField:"checked"}},on:{"checkbox-change":e.handleCheckboxChange}},[a("vxe-column",{attrs:{type:"checkbox",title:"选择",width:"80"}}),a("vxe-column",{attrs:{field:"commodity_details",title:"品名"}}),a("vxe-column",{attrs:{field:"order_number_id",title:"订单号码"}}),a("vxe-column",{attrs:{field:"commodity_size",title:"规格"}}),a("vxe-column",{attrs:{field:"control_no",title:"编号"}}),a("vxe-column",{attrs:{field:"commodity_quantity",title:"库存数量"}})],1),a("vxe-pager",{attrs:{align:"center",size:"mini",background:"","current-page":e.tablePage.currentPage,"page-size":e.tablePage.pageSize,total:e.tablePage.total,layouts:["PrevPage","JumpNumber","NextPage","FullJump","Total"]},on:{"update:currentPage":function(t){return e.$set(e.tablePage,"currentPage",t)},"update:current-page":function(t){return e.$set(e.tablePage,"currentPage",t)},"update:pageSize":function(t){return e.$set(e.tablePage,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tablePage,"pageSize",t)},"page-change":e.handlePageChange}}),a("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[a("vxe-button",{attrs:{status:"primary",content:"确认"},on:{click:e.addProductListEvent}})],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isDivVisible,expression:"!isDivVisible"}]},[a("h4",[e._v("提示：请先到发货单管理菜单添加发货单。")])])])},i=[],r=a("b85c"),o=a("c7eb"),s=a("1da1"),c=a("5530"),l=(a("7db0"),a("c740"),a("d81d"),a("fb6a"),a("a434"),a("b0c0"),a("b680"),a("d3b7"),a("a388")),u=a.n(l),d=a("d96b"),p=a("2f62"),m={computed:Object(c["a"])({},Object(p["b"])(["sidebar","avatar","device","name"])),data:function(){return{tablePage:{total:0,currentPage:1,pageSize:5},checkboxConfig:{reserve:!0},gridOptionsProduct:{resizable:!0,showOverflow:!0,border:"inner",rowConfig:{keyField:"inventoryid",isHover:!0},checkboxConfig:{reserve:!0}},selectoptions:{},isDivVisible:!1,current_shippingid:"",shipping_options:{},modalForm:{project_contact_name:"",shipping_address:"",project_contact_phone:"",driver_name:"",customer_name:"",delivery_date:"",licence_plate:"",username:"",order_number_id:""},searchOrderNumber:"",searchClientNumber:"",modalDisplay:!1,tableData:[],shiptableData:[]}},created:function(){this.current_shippingid=this.$route.query.shippingid,void 0===this.$route.query.shippingid?this.isDivVisible=!1:(this.isDivVisible=!0,this.getShippingInfo(),this.getShippingProductList(),this.getShippingOptions())},mounted:function(){this.modalForm.username=this.name,this.getOptions()},methods:{handleCheckboxChange:function(e,t,a){console.log("Checkbox changed",e)},handleChange:function(e){e.shipping_quantity-e.commodity_quantity>0?(u.a.modal.message({content:"发货数量不可大于库存数量",status:"error"}),e.shipping_quantity=""):e.shipping_weight=(e.shipping_quantity*e.unit_weight).toFixed(2)},onEnterUp:function(e,t){this.gotoNextRow(e)},onDownUp:function(e){e.shipping_quantity=e.commodity_quantity,e.shipping_weight=(e.shipping_quantity*e.unit_weight).toFixed(2),this.gotoNextRow(e)},getOptions:function(){var e=this,t={action:"product_list_view",subaction:"getOptions"};Object(d["a"])(t).then((function(t){console.log(t.data),e.selectoptions=t.data}))},getProjectInfo:function(e){var t=this,a=e.value,n=(e.$event,{action:"project_table_view",subaction:"getProjectInfo",shipping_address:a});Object(d["a"])(n).then((function(e){t.modalForm.project_contact_name=e.data.project_contact_name,t.modalForm.project_contact_phone=e.data.project_contact_phone}))},getDriverInfo:function(e){var t=this,a=e.value,n=(e.$event,{action:"driver_table_view",subaction:"getDriverInfo",driver_name:a});Object(d["a"])(n).then((function(e){t.modalForm.licence_plate=e.data.licence_plate}))},getShippingOptions:function(){var e=this,t={action:"shipping_detail_table_view",subaction:"getShippingOptions",searchForm:{username:this.name}};Object(d["a"])(t).then((function(t){e.shipping_options=t.data}))},getShippingInfo:function(){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a={action:"shipping_table_view",subaction:"query",pageNum:1,pageSize:1,searchForm:{shippingid:e.current_shippingid,username:e.name}},Object(d["a"])(a).then((function(t){var a=t.data[0];e.modalForm.customer_name=a.customer_name}));case 2:case"end":return t.stop()}}),t)})))()},getShippingProductList:function(){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a={action:"shipping_detail_table_view",subaction:"getProductListByShippingId",shippingid:e.current_shippingid,username:e.name},Object(d["a"])(a).then((function(t){e.shiptableData=t.data}));case 2:case"end":return t.stop()}}),t)})))()},getProductList:function(){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a={action:"order_detail_table_view",subaction:"query",pageNum:1,pageSize:1e4,searchForm:{customer_name:e.modalForm.customer_name,username:e.name}},Object(d["a"])(a).then((function(t){e.allData=t.data;var a=e.allData.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{checked:!1})}));e.allData=a,e.tablePage.total=t.data.length;var n=5*(e.tablePage.currentPage-1),i=n+5;e.tableData=e.allData.slice(n,i)}));case 2:case"end":return t.stop()}}),t)})))()},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.tablePage.currentPage=t,this.tablePage.pageSize=a;var n=(this.tablePage.currentPage-1)*this.tablePage.pageSize,i=n+this.tablePage.pageSize;this.tableData=this.allData.slice(n,i)},searchProductBtn:function(){var e=this;return Object(s["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a={action:"order_detail_table_view",subaction:"query",pageNum:1,pageSize:1e4,searchForm:{customer_name:e.modalForm.customer_name,order_number__icontains:e.searchOrderNumber,username:e.name}},Object(d["a"])(a).then((function(t){e.allData=t.data,e.allData=e.allData.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{checked:!1})}));var a,n=e.shiptableData,i=Object(r["a"])(n);try{var o=function(){var t=a.value,n=e.allData.findIndex((function(e){return e.detailid===t.detailid}));!0===t.checked&&-1!==n&&(e.allData[n].checked=!0)};for(i.s();!(a=i.n()).done;)o()}catch(u){i.e(u)}finally{i.f()}e.tablePage.total=t.data.length;var s=5*(e.tablePage.currentPage-1),l=s+5;e.tableData=e.allData.slice(s,l)}));case 2:case"end":return t.stop()}}),t)})))()},addProductEvent:function(e){var t=this;return Object(s["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==t.modalForm.customer_name){e.next=3;break}return u.a.modal.message({content:"请选择客户名称",status:"error"}),e.abrupt("return");case 3:if(""!==t.modalForm.shipping_address){e.next=6;break}return u.a.modal.message({content:"请选择收货地址",status:"error"}),e.abrupt("return");case 6:if(""!==t.modalForm.driver_name){e.next=9;break}return u.a.modal.message({content:"请选择司机",status:"error"}),e.abrupt("return");case 9:if(""!==t.modalForm.username){e.next=12;break}return u.a.modal.message({content:"请选择发货人",status:"error"}),e.abrupt("return");case 12:if(""!==t.modalForm.delivery_date){e.next=15;break}return u.a.modal.message({content:"请选择出货日期",status:"error"}),e.abrupt("return");case 15:t.modalDisplay=!0;case 16:case"end":return e.stop()}}),e)})))()},isDetailIdExists:function(e){var t,a=Object(r["a"])(this.shiptableData);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.detailid===e)return!0}}catch(i){a.e(i)}finally{a.f()}return!1},addProductListEvent:function(){var e,t=this,a=this.allData,n=Object(r["a"])(a);try{var i=function(){var a=e.value,n=t.shiptableData.findIndex((function(e){return e.detailid===a.detailid}));!0!==a.checked||t.shiptableData.find((function(e){return e.detailid===a.detailid}))?!1===a.checked&&t.shiptableData.find((function(e){return e.detailid===a.detailid}))&&t.shiptableData.splice(n,1):(a.shipping_quantity="",t.shiptableData.push(a))};for(n.s();!(e=n.n()).done;)i()}catch(o){n.e(o)}finally{n.f()}console.log(this.shiptableData),this.modalDisplay=!1},saveEvent:function(){var e=this;this.current_shippingid=Math.floor(Date.now())%1e8;var t=this.shiptableData.findIndex((function(e){return""===e.shipping_quantity||isNaN(e.shipping_quantity)}));if(-1===t){var a=this.shiptableData;console.log(a);var n={action:"shipping_detail_table_view",subaction:"saveShippingInfoNew",customer_name:this.modalForm.customer_name,shipping_address:this.modalForm.shipping_address,driver_name:this.modalForm.driver_name,delivery_date:this.modalForm.delivery_date,username:this.modalForm.username,shippingid:this.current_shippingid,productlist:a.map((function(e){return{detailid:e.detailid,shipping_quantity:e.shipping_quantity,shipping_weight:e.shipping_weight,order_number_id:e.order_number_id}}))};Object(d["a"])(n).then((function(t){e.$router.back(),u.a.modal.message({content:"保存成功",status:"success"})}))}else u.a.modal.message({content:"发货数量不可为空,或者必须为数字。",status:"warning"})},deleteRowEvent:function(e){var t=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){t.allData.find((function(t){return t._X_ROW_KEY===e._X_ROW_KEY})).checked=!1,t.tableData.find((function(t){return t._X_ROW_KEY===e._X_ROW_KEY})).checked=!1;var a=t.shiptableData.findIndex((function(t){return t._X_ROW_KEY===e._X_ROW_KEY}));-1!==a&&t.shiptableData.splice(a,1)}))},gotoNextRow:function(e){var t=this,a=this.shiptableData.indexOf(e),n=a+1;if(n<this.shiptableData.length)this.$nextTick((function(){var e=0;e=0===a?14:14+10*a;var n=t.$refs.xTable.$el.querySelectorAll(".vxe-cell--label")[e];n&&n.click()}));else{var i=this.$refs.xTable.$el.querySelectorAll(".vxe-cell--label")[5];console.warn(i),i&&(console.warn("找到数据"),i.click(),i.focus()),console.warn("No next row available")}}}},h=m,f=a("2877"),v=Object(f["a"])(h,n,i,!1,null,"c48e2f76",null);t["default"]=v.exports},d96b:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a("b775");function i(e){return Object(n["a"])({url:"/vue-element-admin/backend/process/",method:"post",data:e})}function r(e){return Object(n["a"])({url:"/vue-element-admin/backend/download_file/",method:"get",params:e})}}}]);